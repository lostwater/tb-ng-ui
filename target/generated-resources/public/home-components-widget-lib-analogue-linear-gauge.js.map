{"version":3,"sources":["./src/app/modules/home/components/widget/lib/analogue-linear-gauge.ts","./src/app/modules/home/components/widget/lib/analogue-linear-gauge.models.ts"],"names":[],"mappings":"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","file":"home-components-widget-lib-analogue-linear-gauge.js","sourcesContent":["///\n/// Copyright © 2016-2021 The Thingsboard Authors\n///\n/// Licensed under the Apache License, Version 2.0 (the \"License\");\n/// you may not use this file except in compliance with the License.\n/// You may obtain a copy of the License at\n///\n///     http://www.apache.org/licenses/LICENSE-2.0\n///\n/// Unless required by applicable law or agreed to in writing, software\n/// distributed under the License is distributed on an \"AS IS\" BASIS,\n/// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n/// See the License for the specific language governing permissions and\n/// limitations under the License.\n///\n\nimport * as CanvasGauges from 'canvas-gauges';\nimport { JsonSettingsSchema } from '@shared/models/widget.models';\nimport { WidgetContext } from '@home/models/widget-component.models';\nimport { TbAnalogueGauge } from '@home/components/widget/lib/analogue-gauge.models';\nimport {\n  AnalogueLinearGaugeSettings,\n  getAnalogueLinearGaugeSettingsSchema\n} from '@home/components/widget/lib/analogue-linear-gauge.models';\nimport { isDefined } from '@core/utils';\nimport * as tinycolor_ from 'tinycolor2';\nimport LinearGaugeOptions = CanvasGauges.LinearGaugeOptions;\nimport LinearGauge = CanvasGauges.LinearGauge;\nimport BaseGauge = CanvasGauges.BaseGauge;\n\nconst tinycolor = tinycolor_;\n\nconst analogueLinearGaugeSettingsSchemaValue = getAnalogueLinearGaugeSettingsSchema();\n\n// @dynamic\nexport class TbAnalogueLinearGauge extends TbAnalogueGauge<AnalogueLinearGaugeSettings, LinearGaugeOptions>{\n\n  static get settingsSchema(): JsonSettingsSchema {\n    return analogueLinearGaugeSettingsSchemaValue;\n  }\n\n  constructor(ctx: WidgetContext, canvasId: string) {\n    super(ctx, canvasId);\n  }\n\n  protected prepareGaugeOptions(settings: AnalogueLinearGaugeSettings, gaugeData: LinearGaugeOptions) {\n    const dataKey = this.ctx.data[0].dataKey;\n    const keyColor = settings.defaultColor || dataKey.color;\n\n    const barStrokeColor = tinycolor(keyColor).darken().setAlpha(0.6).toRgbString();\n    const progressColorStart = tinycolor(keyColor).setAlpha(0.05).toRgbString();\n    const progressColorEnd = tinycolor(keyColor).darken().toRgbString();\n\n    gaugeData.barStrokeWidth = (isDefined(settings.barStrokeWidth) && settings.barStrokeWidth !== null) ? settings.barStrokeWidth : 2.5;\n    gaugeData.colorBarStroke = settings.colorBarStroke || barStrokeColor;\n    gaugeData.colorBar = settings.colorBar || '#fff';\n    gaugeData.colorBarEnd = settings.colorBarEnd || '#ddd';\n    gaugeData.colorBarProgress = settings.colorBarProgress || progressColorStart;\n    gaugeData.colorBarProgressEnd = settings.colorBarProgressEnd || progressColorEnd;\n  }\n\n  protected createGauge(gaugeData: LinearGaugeOptions): BaseGauge {\n    return new LinearGauge(gaugeData);\n  }\n\n}\n","///\n/// Copyright © 2016-2021 The Thingsboard Authors\n///\n/// Licensed under the Apache License, Version 2.0 (the \"License\");\n/// you may not use this file except in compliance with the License.\n/// You may obtain a copy of the License at\n///\n///     http://www.apache.org/licenses/LICENSE-2.0\n///\n/// Unless required by applicable law or agreed to in writing, software\n/// distributed under the License is distributed on an \"AS IS\" BASIS,\n/// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n/// See the License for the specific language governing permissions and\n/// limitations under the License.\n///\n\nimport { JsonSettingsSchema } from '@shared/models/widget.models';\nimport { AnalogueGaugeSettings, analogueGaugeSettingsSchema } from '@home/components/widget/lib/analogue-gauge.models';\nimport { deepClone } from '@core/utils';\n\nexport interface AnalogueLinearGaugeSettings extends AnalogueGaugeSettings {\n  barStrokeWidth: number;\n  colorBarStroke: string;\n  colorBar: string;\n  colorBarEnd: string;\n  colorBarProgress: string;\n  colorBarProgressEnd: string;\n}\n\nexport function getAnalogueLinearGaugeSettingsSchema(): JsonSettingsSchema {\n  const analogueLinearGaugeSettingsSchema = deepClone(analogueGaugeSettingsSchema);\n  analogueLinearGaugeSettingsSchema.schema.properties =\n    {...analogueLinearGaugeSettingsSchema.schema.properties, ...{\n        barStrokeWidth: {\n          title: 'Bar stroke width',\n          type: 'number',\n          default: 2.5\n        },\n        colorBarStroke: {\n          title: 'Bar stroke color',\n          type: 'string',\n          default: null\n        },\n        colorBar: {\n          title: 'Bar background color',\n          type: 'string',\n          default: '#fff'\n        },\n        colorBarEnd: {\n          title: 'Bar background color - end gradient',\n          type: 'string',\n          default: '#ddd'\n        },\n        colorBarProgress: {\n          title: 'Progress bar color',\n          type: 'string',\n          default: null\n        },\n        colorBarProgressEnd: {\n          title: 'Progress bar color - end gradient',\n          type: 'string',\n          default: null\n        }}};\n  analogueLinearGaugeSettingsSchema.form.unshift(\n    'barStrokeWidth',\n    {\n      key: 'colorBarStroke',\n      type: 'color'\n    },\n    {\n      key: 'colorBar',\n      type: 'color'\n    },\n    {\n      key: 'colorBarEnd',\n      type: 'color'\n    },\n    {\n      key: 'colorBarProgress',\n      type: 'color'\n    },\n    {\n      key: 'colorBarProgressEnd',\n      type: 'color'\n    }\n  );\n  return analogueLinearGaugeSettingsSchema;\n}\n"],"sourceRoot":"webpack:///"}